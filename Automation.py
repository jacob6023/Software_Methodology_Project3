import json

null = "null"
data = {
    "match_details": {
        "confidence_score": 0.77,
        "matched_on": [
            "company_name",
            "location"
        ],
        "attributes": {
            "company_name": {
                "confidence_score": 1,
                "match_type": "Exact",
                "match_source": "Company Alternate Names",
                "value": "Health Map"
            },
            "location": {
                "confidence_score": 0.25,
                "match_type": "Partial",
                "match_source": "Primary",
                "match_element": "Country",
                "value": {
                    "country_code": "US",
                    "country": "United States",
                    "region": "South Carolina",
                    "city": "Westminster",
                    "street": null,
                    "street_number": null,
                    "postcode": "29693",
                    "latitude": 34.63982519827728,
                    "longitude": -83.11211919114028
                }
            },
            "website": {
                "confidence_score": 0,
                "match_type": null,
                "match_source": null,
                "value": null
            },
            "phone": {
                "confidence_score": 0,
                "match_type": null,
                "match_source": null,
                "value": null
            },
            "registry_id": {
                "confidence_score": 0,
                "match_type": null,
                "match_source": null,
                "value": null
            }
        }
    },
    "veridion_id": "a473ef65-93e4-11eb-8e19-198fb02d6f96",
    "company_name": "HealthMap",
    "registered_name": null,
    "company_commercial_names": [
        "HealthMap",
        "Health Map"
    ],
    "company_legal_names": null,
    "main_address": {
        "country_code": "US",
        "country": "United States",
        "region": "South Carolina",
        "city": "Westminster",
        "street": null,
        "street_number": null,
        "postcode": "29693",
        "latitude": null,
        "longitude": null
    },
    "locations": [
        {
            "country_code": "US",
            "country": "United States",
            "region": "South Carolina",
            "city": "Westminster",
            "street": null,
            "street_number": null,
            "postcode": "29693",
            "latitude": 34.63982519827728,
            "longitude": -83.11211919114028
        }
    ],
    "num_locations": 1,
    "registered_address": null,
    "jurisdiction": null,
    "legal_form": null,
    "company_type": "Private",
    "company_status": null,
    "year_founded": 2006,
    "incorporation_date": null,
    "lei": null,
    "ein": null,
    "vat_id": null,
    "tin": null,
    "registry_ids": null,
    "main_business_category": "Clinics - Surgeons & Physicians",
    "main_industry": "Hospitals & Clinics",
    "main_sector": "Health Care & Social Assistance",
    "naics_2022": {
        "primary": {
            "code": "622110",
            "label": "General Medical and Surgical Hospitals"
        },
        "secondary": null
    },
    "nace_rev2": [
        {
            "code": "86.1",
            "label": "Hospital activities"
        }
    ],
    "ncci_codes_28_1": [
        "8833",
        "9040"
    ],
    "sic": [
        {
            "code": "8062",
            "label": "General Medical and Surgical Hospitals"
        },
        {
            "code": "8069",
            "label": "Specialty Hospitals, Except Psychiatric (childrenâ€™s hospitals)"
        }
    ],
    "isic_v4": [
        {
            "code": "8610",
            "label": "Hospital activities"
        }
    ],
    "ibc_insurance": null,
    "sics_industry": {
        "code": "HC-DY",
        "label": "Health Care Delivery"
    },
    "sics_sector": {
        "code": "HC",
        "label": "Health Care"
    },
    "sics_subsector": {
        "code": "HC.3",
        "label": "Health Care Providers"
    },
    "short_description": "HealthMap brings together disparate data sources to achieve a unified and comprehensive view of the current global state of infectious diseases.",
    "long_description_extracted": "Visit your profile page to set up email alerts. Twelve disease categories are used to help you quickly find what you're looking for within your local area. Diseases transmitted to people or animals by arthropods including mosquitoes, ticks, flies, and fleas. HealthMap brings together disparate data sources, including online news aggregators, eyewitness reports, expert-curated discussions and validated official reports, to achieve a unified and comprehensive view of the current global state of infectious diseases and its effect on human and animal health.",
    "long_description_generated": "HealthMap is a company that provides a comprehensive view of the current global state of infectious diseases by bringing together data sources to achieve a unified and unified view. They use twelve disease categories to help users quickly find what they're looking for within their local area, including environmental risks, animal diseases, hospital-acquired infections, and diseases affecting the nervous system. HealthMap also keeps track of environmental changes that may impact human health, such as natural/man-made disasters, heat waves, and volcanic eruptions. They assign a composite score based on the disease importance and the news volume associated with the alert in the absence of user ratings.",
    "business_tags_extracted": [
        "Influenza",
        "Meningitis",
        "Infectious Diseases",
        "Sexually Transmitted Infections",
        "Pneumonia",
        "Feline Immunodeficiency Virus",
        "Pelvic Inflammatory Disease",
        "African Swine Fever",
        "Tick Borne Diseases",
        "Emerald Ash Borer"
    ],
    "business_tags_generated": [
        "Data Analysis",
        "Data Collection and Analysis",
        "Data Analysis for Infectious Diseases",
        "Disease Trend Identification",
        "Case Counts",
        "COVID-19 News",
        "Animal Diseases Monitoring",
        "COID-19 Case Count",
        "Data Analysis Services",
        "Disease Location Information",
        "Global State of Infectious Diseases",
        "Global Infectious Diseases Research"
    ],
    "employee_count": {
        "value": 3,
        "type": "Extracted"
    },
    "revenue": {
        "value": 473752,
        "type": "Modelled"
    },
    "primary_phone": "+13077394544",
    "phone_numbers": [
        "+13077394544"
    ],
    "primary_email": null,
    "emails": null,
    "website_url": "https://healthmap.org/formobile/",
    "website_domain": "healthmap.org",
    "website_tld": "org",
    "website_language_code": "en",
    "facebook_url": "https://www.facebook.com/healthmap/",
    "twitter_url": "https://twitter.com/healthmap",
    "instagram_url": null,
    "linkedin_url": "http://www.linkedin.com/company/la-donna-beauty-salon",
    "ios_app_url": null,
    "android_app_url": null,
    "youtube_url": null,
    "technologies": [
        "maps: google maps",
        "reverse proxies: nginx",
        "javascript libraries: modernizr",
        "javascript graphics: d3",
        "miscellaneous: open graph",
        "font scripts: font awesome",
        "javascript libraries: jquery ui",
        "video players: vimeo",
        "javascript libraries: fancybox",
        "javascript libraries: jquery",
        "javascript libraries: datatables",
        "web servers: nginx",
        "programming languages: php",
        "javascript libraries: jquery migrate",
        "analytics: google analytics"
    ],
    "created_at": "2019-11-24T03:28:52.000Z",
    "last_updated_at": "2024-03-19T07:57:27.758Z"
}

company_info = {
    "Company Name": data.get("company_name", ""),
    "Match Score": data.get("match_details", {}).get("confidence_score", ""),
    "Address": f'{data.get("main_address", {}).get("street_number", "")} {data.get("main_address", {}).get("street", "")}',
    "City": data.get("main_address", {}).get("city", ""),
    "Zip Code": data.get("main_address", {}).get("postcode", ""),
    "Company Type": data.get("company_type", ""),
    "Year Founded": data.get("year_founded", ""),
    "Industry 1": data.get("main_industry", ""),
    "Industry 2": data.get("main_industry", ""),
    "Industry 3": data.get("main_industry", ""),
    "NAICS Codes": data.get("naics_2022", {}).get("primary", {}).get("code", ""),
    "NCCI Codes": ", ".join(data.get("ncci_codes_28_1", [])),
    "SIC Codes": ", ".join([sic.get("code") for sic in data.get("sic", [])]),
#    "IBC Insurance Codes": ", ".join([ibc.get("code") for ibc in data.get("ibc_insurance", [])]),
    "Short Description": data.get("short_description", ""),
    "Employee Number": data.get("employee_count", ""),
    "Revenue Number": data.get("revenue", ""),
    "Domain URL": data.get("website_url", "")
}

# Format for easy copy-pasting into Excel
output = "\n".join([
    company_info["Company Name"],
    str(company_info["Match Score"]),
    company_info["Address"],
    company_info["City"],
    "FL",
    company_info["Zip Code"],
    company_info["Company Type"],
    str(company_info["Year Founded"]),
    company_info["Industry 1"],
    company_info["Industry 2"],
    company_info["Industry 3"],
    company_info["NAICS Codes"],
    company_info["NCCI Codes"],
    company_info["SIC Codes"],
    
   #company_info["IBC Insurance Codes"],
   null,
    company_info["Short Description"],
    str(company_info["Employee Number"]),
    str(company_info["Revenue Number"]),
    company_info["Domain URL"]
])

print(output)
